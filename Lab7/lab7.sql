-- 1
DELIMITER //
CREATE PROCEDURE viewEmp(IN ID INT)
BEGIN
SELECT *
FROM EMP
WHERE EMPNO = ID
;
END
//
DELIMITER ;
CALL viewEmp(1)
;

-- 2
DELIMITER //
CREATE PROCEDURE insertEmp(IN ID INT, IN NAME VARCHAR(20), IN JOBNAME VARCHAR(20), IN NUMBER INT, IN SALARY INT)
BEGIN
INSERT INTO EMP VALUES
(ID, NAME, JOBNAME, NUMBER, SALARY)
;
END
//
DELIMITER ;
CALL insertEmp(6, 'Harry', 'Wizard', 6, 40000)
;

-- 3
DELIMITER //
CREATE PROCEDURE raiseSal(IN ID INT, IN INCREASE INT)
BEGIN
UPDATE EMP
SET SAL = SAL + INCREASE
WHERE EMPNO = ID
;
END
//
DELIMITER ;
CALL raiseSal(2, 10000)
;

-- 4
DELIMITER //
CREATE PROCEDURE delRecord(IN NAME VARCHAR(20))
BEGIN
DELETE FROM EMP
WHERE ENAME = NAME
;
END
//
DELIMITER ;
CALL delRecord('Harry')
;

-- 5
DELIMITER //
CREATE FUNCTION minSalary()
RETURNS INT
BEGIN
RETURN (
    SELECT MIN(SAL)
    FROM EMP
)
;
END
//
DELIMITER ;
SELECT minSalary()
;

-- 6
DELIMITER //
CREATE FUNCTION countEmp()
RETURNS INT
BEGIN
RETURN (
    SELECT COUNT(*)
    FROM EMP
)
;
END
//
DELIMITER ;
SELECT countEmp()
;

-- 7
DELIMITER //
CREATE FUNCTION salaryView(ID INT)
RETURNS INT
BEGIN
RETURN (
    SELECT SAL
    FROM EMP
    WHERE EMPNO = ID
)
;
END
//
DELIMITER ;
SELECT salaryView(5)
;

-- 8
DELIMITER //
CREATE FUNCTION avgSal(DNO INT)
RETURNS INT
BEGIN
RETURN (
    SELECT AVG(SAL)
    FROM EMP
    WHERE DEPTNO = DNO
)
;
END
//
DELIMITER ;
SELECT avgSal(4)
;

-- 9
DELIMITER //
CREATE PROCEDURE deptList(IN DNO INT)
BEGIN
SELECT ENAME
FROM EMP
WHERE DEPTNO = DNO
;
END
//
DELIMITER ;
CALL deptList(4)
;

-- 10
DELIMITER //
CREATE FUNCTION dept_highest(DNO INT)
RETURN INT
BEGIN
RETURN (
    SELECT MAX(SAL)
    FROM EMP
    WHERE DEPTNO = DNO
)
;
END
//
CREATE PROCEDURE maxSal()
BEGIN
SELECT dept_highest(DEPTNO)
FROM DEPT
;
END
//
DELIMITER ;
CALL maxSal()
;

-- 11
DELIMITER //
CREATE FUNCTION salMoreThan(NUMBER INT)
RETURNS INT
BEGIN
RETURNS (
    SELECT COUNT(*)
    FROM EMP
    WHERE SAL > NUMBER
)
;
END
//
DELIMITER ;
SELECT salMoreThan(30000)
;

-- 12
DELIMITER //
CREATE FUNCTION cityCount(CITY VARCHAR(20))
RETURNS INT
BEGIN
RETURN (
    SELECT COUNT(*)
    FROM EMP
    WHERE DEPTNO = (
        SELECT DEPTNO
        FROM DEPT
        WHERE LOC = CITY
    )
)
;
END
//
DELIMITER ;
SELECT cityCount('Mumbai')
;
